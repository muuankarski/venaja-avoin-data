{
    "contents" : "# paketin asentaminen githubista\nlibrary(devtools)\ninstall_github(\"r.eusilc\",\"muuankarski\")\n\n# yksi vaihtoehto\n\n1. yhdistää data R:ssä ja tallentaa se \"csv\"-muodossa\n2. yhdistää gesiksen paneeliskriptit http://www.gesis.org/en/services/data-analysis/official-microdata/european-microdata/eu-silc/eu-silc-tools/\n3. ajaa skripti antamalla yhdistetyn datan .csv-polku skriptiin\n  \n\n\n# analyysi\nlibrary(r.eusilc)\n\n## asetetaan polut originaaleihin\npath.raw.08 <- \"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\raw\\\\2008\\\\longi_rev4\\\\\"\npath.raw.09 <- \"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\raw\\\\2009\\\\longi_rev3\\\\\"\npath.raw.10 <- \"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\raw\\\\2010\\\\longi_rev1\\\\\"\n## asetetaan polut yhdistettyihin\npath.merged <- \"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\merged\\\\all\\\\\"\n\n## Maat kaikki vuodet samat\ncntry.list <- c(\"BG\",\"PT\",\"PL\",\"CY\",\"FR\", # KE\n                \"NL\",\"FI\",\"NO\",\"SE\", # PU\n                \"EE\",\"AT\",\"DE\",\"DK\", # VI\n                \"SK\",\"HU\",\"IE\",\"UK\",\"ES\",\"BE\",\"SI\") # SI\n\n# Muuttujalistat\n\n## risuaidalla merkittyjä muuttujia EI LÖYDY!!\n\n## Personal register register - kaikki vuodet sama\nvarlist.per.reg <- c(\"RB030\", # Personal ID\n                     \"RB080\", # Year of birth\n                     \"RB090\", # Sex\n                     \"RB200\", # Residential Status\n                     \"RB210\", # Basic activity status\n                     \"RB220\", # Father ID\n                     \"RB230\", # Mother ID\n                     \"RB240\", # Spouse/partner ID\n                     \"RB245\", # Respondent status\n                     \"RX010\") # Age at the date of the interview\n\n## Personal register data - 2008 oma lista (PL030 case)\nvarlist.per.data.08 <- c(\"PB190\", # Marital status\n                      \"PB200\", # Consensual union\n                    #  \"PE010\", # Current education activity\n                    #  \"PE020\", # ISCED level currently attended\n                    #  \"PE030\", # Year when highest level of education was attained\n                      \"PE040\", # Highest ISCED level attained\n                      \"PL030\", # Self-defined current economic status OLD\n                    #  \"PL031\", # Self-defined current economic status NEW\n                    #  \"PL015\", # Person has ever worked\n                      \"PL020\", # Actively looking for a job\n                      \"PL025\", # Available for work\n                      \"PL040\", # Status in employment\n                      \"PL050\", # Occupation (ISCO-88 (Com))\n                    #  \"PL070\", # Number of months spent at full-time work\n                    #  \"PL072\", # Number of months spent at part-time work\n                    #  \"PL080\", # Number of months spent in unemployment\n                    #  \"PL087\", # Number of months spent studying\n                    #  \"PL120\", # Reason for working less than 30 hours\n                      \"PL140\", # Type of contract\n                      \"PL160\", # Change of job since last year\n                      \"PL170\", # Reason for change\n                      \"PL180\", # Most recent change in the individuals activity status\n                      \"PL190\", # When began regular first job\n                      \"PL200\", # Number of years spent in paid work\n                      \"PY090N\", # Unemployment benefits(net)\n                      \"PY140N\", # Education-related allowances\n                      \"PY090G\", # Unemployment benefits (gross)\n                      \"PY140G\") # Education-related allowances(gross)\n                    #  \"PM070\", # Main occupation of father\n                    #  \"PM090\", # Main occupation of mother\n                    #  \"PM100\" # Financial problems in household when young teenager (DE,EL,PT:information not provided\n                    \n\n## Personal register data - 2009 -> oma lista (PL031 case)\nvarlist.per.data <- c(\"PB190\", # Marital status\n                         \"PB200\", # Consensual union\n                         #  \"PE010\", # Current education activity\n                         #  \"PE020\", # ISCED level currently attended\n                         #  \"PE030\", # Year when highest level of education was attained\n                         \"PE040\", # Highest ISCED level attained\n                         \"PL030\", # Self-defined current economic status OLD\n                         \"PL031\", # Self-defined current economic status NEW\n                         #  \"PL015\", # Person has ever worked\n                         \"PL020\", # Actively looking for a job\n                         \"PL025\", # Available for work\n                         \"PL040\", # Status in employment\n                         \"PL050\", # Occupation (ISCO-88 (Com))\n                         #  \"PL070\", # Number of months spent at full-time work\n                         #  \"PL072\", # Number of months spent at part-time work\n                         #  \"PL080\", # Number of months spent in unemployment\n                         #  \"PL087\", # Number of months spent studying\n                         #  \"PL120\", # Reason for working less than 30 hours\n                         \"PL140\", # Type of contract\n                         \"PL160\", # Change of job since last year\n                         \"PL170\", # Reason for change\n                         \"PL180\", # Most recent change in the individuals activity status\n                         \"PL190\", # When began regular first job\n                         \"PL200\", # Number of years spent in paid work\n                         \"PY090N\", # Unemployment benefits(net)\n                         \"PY140N\", # Education-related allowances\n                         \"PY090G\", # Unemployment benefits (gross)\n                         \"PY140G\") # Education-related allowances(gross)\n                         #  \"PM070\", # Main occupation of father\n                         #  \"PM090\", # Main occupation of mother\n                         #  \"PM100\", # Financial problems in household when young teenager (DE,EL,PT:information not provided\n                        \n\n## Household register - kaikille samat\n\nvarlist.hh.reg <- c(\"DB030\", # Household ID\n                    \"DB110\") # Household status\n\n## Household data - kaikille samat\n\nvarlist.hh.data <- c(\"HY010\", # Total Household Gross Income\n                    \"HY020\", # total disposable household income\n                    \"HY022\", # Total Transposable Household Income before social transfers other than old-age and survivors benefits\n                    \"HY023\", # Total disposable Household income before social transfers including old-age and survivors benefits\n                    \"HY050N\", # Family/Children related allowances (net)\n                    \"HY070N\", # Housing Allowances(net)\n                    \"HY080N\", # Regular inter-household cash received (net)\n                    \"HY050G\", # Family/Children related allowances (gross)\n                    \"HY070G\", # Housing Allowances(gross)\n                    \"HY080G\", # Regular inter-household cash received (gross)\n                    \"HS140\", # Financial burden of the total housing cost\n                  #  \"HH070\", # Total Housing cost\n                    \"HX040\", # Household size\n                    \"HX050\", # Equivalent household size\n                    \"HX090\") # Equivalized disposable household income\n\n\n## ------------------------------------------------ ##\n## ------------   YHDISTETÄÄN DATAT    ------------ ##\n## ------------------------------------------------ ##\n\n\n\nboth_longi_2008 <- merge_eusilc(origin.path=path.raw.08,\n                                output.path=path.merged,\n                                level=\"both\",\n                                type=\"longitudinal\",\n                                year=\"2008\",\n                                format=\"RData\",\n                                subset.vars.per.reg=varlist.per.reg,\n                                subset.vars.per.data=varlist.per.data.08,\n                                subset.vars.hh.reg=varlist.hh.reg,\n                                subset.vars.hh.data=varlist.hh.data,\n                                subset.countries=cntry.list) \n\n\nboth_longi_2009 <- merge_eusilc(origin.path=path.raw.09,\n                                output.path=path.merged,\n                                level=\"both\",\n                                type=\"longitudinal\",\n                                year=\"2009\",\n                                format=\"RData\",\n                                subset.vars.per.reg=varlist.per.reg,\n                                subset.vars.per.data=varlist.per.data,\n                                subset.vars.hh.reg=varlist.hh.reg,\n                                subset.vars.hh.data=varlist.hh.data,\n                                subset.countries=cntry.list) \n\n\nboth_longi_2010 <- merge_eusilc(origin.path=path.raw.10,\n                                output.path=path.merged,\n                                level=\"both\",\n                                type=\"longitudinal\",\n                                year=\"2010\",\n                                format=\"RData\",\n                                subset.vars.per.reg=varlist.per.reg,\n                                subset.vars.per.data=varlist.per.data,\n                                subset.vars.hh.reg=varlist.hh.reg,\n                                subset.vars.hh.data=varlist.hh.data,\n                                subset.countries=cntry.list) \n\n## ------------------------------------------------ ##\n## ------------   Manuaalinen yhdistäminen -------- ##\n## ------------------------------------------------ ##\nvars <- c(\"PER_ID\",\"PER_ID_Y\",\"HH_ID\",\"HH_ID_Y\",\n     \"RB030\", # Personal ID\n     \"RB080\", # Year of birth\n     \"RB090\", # Sex\n     \"RB200\", # Residential Status\n     \"RB210\", # Basic activity status\n     \"RB220\", # Father ID\n     \"RB230\", # Mother ID\n     \"RB240\", # Spouse/partner ID\n     \"RB245\", # Respondent status\n     \"RX010\", # Age at the data of the interview\n     \"PB190\", # Marital status\n     \"PB200\", # Consensual union\n     #  \"PE010\", # Current education activity\n     #  \"PE020\", # ISCED level currently attended\n     #  \"PE030\", # Year when highest level of education was attained\n     \"PE040\", # Highest ISCED level attained\n     \"PL030\", # Self-defined current economic status OLD\n       \"PL031\", # Self-defined current economic status NEW\n     #  \"PL015\", # Person has ever worked\n     \"PL020\", # Actively looking for a job\n     \"PL025\", # Available for work\n     \"PL040\", # Status in employment\n     \"PL050\", # Occupation (ISCO-88 (Com))\n     #  \"PL070\", # Number of months spent at full-time work\n     #  \"PL072\", # Number of months spent at part-time work\n     #  \"PL080\", # Number of months spent in unemployment\n     #  \"PL087\", # Number of months spent studying\n     #  \"PL120\", # Reason for working less than 30 hours\n     \"PL140\", # Type of contract\n     \"PL160\", # Change of job since last year\n     \"PL170\", # Reason for change\n     \"PL180\", # Most recent change in the individuals activity status\n     \"PL190\", # When began regular first job\n     \"PL200\", # Number of years spent in paid work\n     \"PY090N\", # Unemployment benefits(net)\n     \"PY140N\", # Education-related allowances\n     \"PY090G\", # Unemployment benefits (gross)\n     \"PY140G\",\n     \"PB190\", # Marital status\n     \"PB200\", # Consensual union\n     #  \"PE010\", # Current education activity\n     #  \"PE020\", # ISCED level currently attended\n     #  \"PE030\", # Year when highest level of education was attained\n     \"PE040\", # Highest ISCED level attained\n     \"PL030\", # Self-defined current economic status OLD\n     \"PL031\", # Self-defined current economic status NEW\n     #  \"PL015\", # Person has ever worked\n     \"PL020\", # Actively looking for a job\n     \"PL025\", # Available for work\n     \"PL040\", # Status in employment\n     \"PL050\", # Occupation (ISCO-88 (Com))\n     #  \"PL070\", # Number of months spent at full-time work\n     #  \"PL072\", # Number of months spent at part-time work\n     #  \"PL080\", # Number of months spent in unemployment\n     #  \"PL087\", # Number of months spent studying\n     #  \"PL120\", # Reason for working less than 30 hours\n     \"PL140\", # Type of contract\n     \"PL160\", # Change of job since last year\n     \"PL170\", # Reason for change\n     \"PL180\", # Most recent change in the individuals activity status\n     \"PL190\", # When began regular first job\n     \"PL200\", # Number of years spent in paid work\n     \"PY090N\", # Unemployment benefits(net)\n     \"PY140N\", # Education-related allowances\n     \"PY090G\", # Unemployment benefits (gross)\n     \"PY140G\",\n     \"DB030\", # Household ID\n     \"DB110\",\n     \"HY010\", # Total Household Gross Income\n     \"HY020\", # total disposable household income\n     \"HY022\", # Total Transposable Household Income before social transfers other than old-age and survivors benefits\n     \"HY023\", # Total disposable Household income before social transfers including old-age and survivors benefits\n     \"HY050N\", # Family/Children related allowances (net)\n     \"HY070N\", # Housing Allowances(net)\n     \"HY080N\", # Regular inter-household cash received (net)\n     \"HY050G\", # Family/Children related allowances (gross)\n     \"HY070G\", # Housing Allowances(gross)\n     \"HY080G\", # Regular inter-household cash received (gross)\n     \"HS140\", # Financial burden of the total housing cost\n     #  \"HH070\", # Total Housing cost\n     \"HX040\", # Household size\n     \"HX050\", # Equivalent household size\n     \"HX090\") # Equivalized disposable household income\n\n\nvars08 <- c(\"PER_ID\",\"PER_ID_Y\",\"HH_ID\",\"HH_ID_Y\",\n          \"RB030\", # Personal ID\n          \"RB080\", # Year of birth\n          \"RB090\", # Sex\n          \"RB200\", # Residential Status\n          \"RB210\", # Basic activity status\n          \"RB220\", # Father ID\n          \"RB230\", # Mother ID\n          \"RB240\", # Spouse/partner ID\n          \"RB245\", # Respondent status\n          \"RX010\",\n          \"PB190\", # Marital status\n          \"PB200\", # Consensual union\n          #  \"PE010\", # Current education activity\n          #  \"PE020\", # ISCED level currently attended\n          #  \"PE030\", # Year when highest level of education was attained\n          \"PE040\", # Highest ISCED level attained\n          \"PL030\", # Self-defined current economic status OLD\n          #  \"PL031\", # Self-defined current economic status NEW\n          #  \"PL015\", # Person has ever worked\n          \"PL020\", # Actively looking for a job\n          \"PL025\", # Available for work\n          \"PL040\", # Status in employment\n          \"PL050\", # Occupation (ISCO-88 (Com))\n          #  \"PL070\", # Number of months spent at full-time work\n          #  \"PL072\", # Number of months spent at part-time work\n          #  \"PL080\", # Number of months spent in unemployment\n          #  \"PL087\", # Number of months spent studying\n          #  \"PL120\", # Reason for working less than 30 hours\n          \"PL140\", # Type of contract\n          \"PL160\", # Change of job since last year\n          \"PL170\", # Reason for change\n          \"PL180\", # Most recent change in the individuals activity status\n          \"PL190\", # When began regular first job\n          \"PL200\", # Number of years spent in paid work\n          \"PY090N\", # Unemployment benefits(net)\n          \"PY140N\", # Education-related allowances\n          \"PY090G\", # Unemployment benefits (gross)\n          \"PY140G\",\n          \"PB190\", # Marital status\n          \"PB200\", # Consensual union\n          #  \"PE010\", # Current education activity\n          #  \"PE020\", # ISCED level currently attended\n          #  \"PE030\", # Year when highest level of education was attained\n          \"PE040\", # Highest ISCED level attained\n          \"PL030\", # Self-defined current economic status OLD\n          #\"PL031\", # Self-defined current economic status NEW\n          #  \"PL015\", # Person has ever worked\n          \"PL020\", # Actively looking for a job\n          \"PL025\", # Available for work\n          \"PL040\", # Status in employment\n          \"PL050\", # Occupation (ISCO-88 (Com))\n          #  \"PL070\", # Number of months spent at full-time work\n          #  \"PL072\", # Number of months spent at part-time work\n          #  \"PL080\", # Number of months spent in unemployment\n          #  \"PL087\", # Number of months spent studying\n          #  \"PL120\", # Reason for working less than 30 hours\n          \"PL140\", # Type of contract\n          \"PL160\", # Change of job since last year\n          \"PL170\", # Reason for change\n          \"PL180\", # Most recent change in the individuals activity status\n          \"PL190\", # When began regular first job\n          \"PL200\", # Number of years spent in paid work\n          \"PY090N\", # Unemployment benefits(net)\n          \"PY140N\", # Education-related allowances\n          \"PY090G\", # Unemployment benefits (gross)\n          \"PY140G\",\n          \"DB030\", # Household ID\n          \"DB110\",\n          \"HY010\", # Total Household Gross Income\n          \"HY020\", # total disposable household income\n          \"HY022\", # Total Transposable Household Income before social transfers other than old-age and survivors benefits\n          \"HY023\", # Total disposable Household income before social transfers including old-age and survivors benefits\n          \"HY050N\", # Family/Children related allowances (net)\n          \"HY070N\", # Housing Allowances(net)\n          \"HY080N\", # Regular inter-household cash received (net)\n          \"HY050G\", # Family/Children related allowances (gross)\n          \"HY070G\", # Housing Allowances(gross)\n          \"HY080G\", # Regular inter-household cash received (gross)\n          \"HS140\", # Financial burden of the total housing cost\n          #  \"HH070\", # Total Housing cost\n          \"HX040\", # Household size\n          \"HX050\", # Equivalent household size\n          \"HX090\") # Equivalized disposable household income\n\n\n## 2008\n\n# household register \nhh_reg <- read.csv(\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\raw\\\\2008\\\\longi_rev4\\\\d_file.csv\", header=TRUE)\nhh_reg$HH_ID_Y <- factor(paste(hh_reg$DB010,hh_reg$DB020,hh_reg$DB030, sep=\"_\"))\nhh_reg$HH_ID <- factor(paste(hh_reg$DB010,hh_reg$DB020,hh_reg$DB030, sep=\"_\"))\n# household data\nhh_data <- read.csv(\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\raw\\\\2008\\\\longi_rev4\\\\h_file.csv\", header=TRUE)\nhh_data$HH_ID_Y <- factor(paste(hh_data$HB010,hh_data$HB020,hh_data$HB030, sep=\"_\"))\nhh_data$HH_ID <- factor(paste(hh_data$HB010,hh_data$HB020,hh_data$HB030, sep=\"_\"))\n# personal register\nper_reg <- read.csv(\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\raw\\\\2008\\\\longi_rev4\\\\r_file.csv\", header=TRUE)\nper_reg$PER_ID_Y <- factor(paste(per_reg$RB010,per_reg$RB020,per_reg$RB030, sep=\"_\"))\nper_reg$PER_ID <- factor(paste(per_reg$RB010,per_reg$RB020,per_reg$RB030, sep=\"_\"))\n# personal data\nper_data <- read.csv(\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\raw\\\\2008\\\\longi_rev4\\\\p_file.csv\", header=TRUE)\nper_data$PER_ID_Y <- factor(paste(per_data$PB010,per_data$PB020,per_data$PB030, sep=\"_\"))\nper_data$PER_ID <- factor(paste(per_data$PB010,per_data$PB020,per_data$PB030, sep=\"_\"))\n#--------------------------------------------------------------------#\n# merge data\n# merge household datas\nlibrary(plyr)\nhh_merge <- join(hh_reg,hh_data,by=\"HH_ID_Y\", type=\"full\")\n# merge personal datas\nper_merge <- join(per_reg,per_data,by=\"PER_ID_Y\", type=\"full\")\nper_merge$HH_ID_Y <- factor(paste(per_merge$RB010,per_merge$RB020,per_merge$PX030, sep=\"_\"))\n# merge household and personal into single data\nrm(list=setdiff(ls(), c(\"hh_merge\",\"per_merge\",\"vars\",\"vars08\")))\nmerge <- join(hh_merge,per_merge,by=\"HH_ID_Y\", type=\"full\")\nboth_longi_2008 <- merge[,vars08] \nrm(per_merge)\nrm(hh_merge)\nrm(merge)\n#--------------------------------------------------------------------#\n# Write merged file separate .RData files\nsave(both_longi_2008, file=\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\merged\\\\all\\\\both_longi_2008.RData\")\n\n# duplikaattien poistaminen\nboth_longi_2008$PB190.1 <- NULL\nboth_longi_2008$PB200.1 <- NULL\nboth_longi_2008$PE040.1 <- NULL\nboth_longi_2008$PL030.1 <- NULL\nboth_longi_2008$PL020.1 <- NULL\nboth_longi_2008$PL025.1 <- NULL\nboth_longi_2008$PL040.1 <- NULL\nboth_longi_2008$PL050.1 <- NULL\nboth_longi_2008$PL140.1 <- NULL\nboth_longi_2008$PL160.1 <- NULL\nboth_longi_2008$PL170.1 <- NULL\nboth_longi_2008$PL180.1 <- NULL\nboth_longi_2008$PL190.1 <- NULL\nboth_longi_2008$PL200.1 <- NULL\nboth_longi_2008$PY090N.1 <- NULL\nboth_longi_2008$PY140N.1 <- NULL\nboth_longi_2008$PY090G.1 <- NULL\nboth_longi_2008$PY140G.1 <- NULL\n\n\n\n\n## 2009\n\n# household register \nhh_reg <- read.csv(\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\raw\\\\2009\\\\longi_rev3\\\\d_file.csv\", header=TRUE)\nhh_reg$HH_ID_Y <- factor(paste(hh_reg$DB010,hh_reg$DB020,hh_reg$DB030, sep=\"_\"))\nhh_reg$HH_ID <- factor(paste(hh_reg$DB010,hh_reg$DB020,hh_reg$DB030, sep=\"_\"))\n# household data\nhh_data <- read.csv(\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\raw\\\\2009\\\\longi_rev3\\\\h_file.csv\", header=TRUE)\nhh_data$HH_ID_Y <- factor(paste(hh_data$HB010,hh_data$HB020,hh_data$HB030, sep=\"_\"))\nhh_data$HH_ID <- factor(paste(hh_data$HB010,hh_data$HB020,hh_data$HB030, sep=\"_\"))\n# personal register\nper_reg <- read.csv(\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\raw\\\\2009\\\\longi_rev3\\\\r_file.csv\", header=TRUE)\nper_reg$PER_ID_Y <- factor(paste(per_reg$RB010,per_reg$RB020,per_reg$RB030, sep=\"_\"))\nper_reg$PER_ID <- factor(paste(per_reg$RB010,per_reg$RB020,per_reg$RB030, sep=\"_\"))\n# personal data\nper_data <- read.csv(\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\raw\\\\2009\\\\longi_rev3\\\\p_file.csv\", header=TRUE)\nper_data$PER_ID_Y <- factor(paste(per_data$PB010,per_data$PB020,per_data$PB030, sep=\"_\"))\nper_data$PER_ID <- factor(paste(per_data$PB010,per_data$PB020,per_data$PB030, sep=\"_\"))\n#--------------------------------------------------------------------#\n# merge data\n# merge household datas\nlibrary(plyr)\nhh_merge <- join(hh_reg,hh_data,by=\"HH_ID_Y\", type=\"full\")\n# merge personal datas\nper_merge <- join(per_reg,per_data,by=\"PER_ID_Y\", type=\"full\")\nper_merge$HH_ID_Y <- factor(paste(per_merge$RB010,per_merge$RB020,per_merge$PX030, sep=\"_\"))\n# merge household and personal into single data\nrm(list=setdiff(ls(), c(\"hh_merge\",\"per_merge\",\"vars\",\"vars08\")))\nmerge <- join(hh_merge,per_merge,by=\"HH_ID_Y\", type=\"full\")\nboth_longi_2009 <- merge[,vars] \nrm(per_merge)\nrm(hh_merge)\nrm(merge)\n#--------------------------------------------------------------------#\n# Write merged file separate .RData files\nsave(both_longi_2009, file=\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\merged\\\\all\\\\both_longi_2009.RData\")\n\n# duplikaattien poistaminen\nboth_longi_2009$PB190.1 <- NULL\nboth_longi_2009$PB200.1 <- NULL\nboth_longi_2009$PE040.1 <- NULL\nboth_longi_2009$PL030.1 <- NULL\nboth_longi_2009$PL031.1 <- NULL\nboth_longi_2009$PL020.1 <- NULL\nboth_longi_2009$PL025.1 <- NULL\nboth_longi_2009$PL040.1 <- NULL\nboth_longi_2009$PL050.1 <- NULL\nboth_longi_2009$PL140.1 <- NULL\nboth_longi_2009$PL160.1 <- NULL\nboth_longi_2009$PL170.1 <- NULL\nboth_longi_2009$PL180.1 <- NULL\nboth_longi_2009$PL190.1 <- NULL\nboth_longi_2009$PL200.1 <- NULL\nboth_longi_2009$PY090N.1 <- NULL\nboth_longi_2009$PY140N.1 <- NULL\nboth_longi_2009$PY090G.1 <- NULL\nboth_longi_2009$PY140G.1 <- NULL\n\n\n\n\n\n## 2010\n\n# household register \nhh_reg <- read.csv(\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\raw\\\\2010\\\\longi_rev1\\\\d_file.csv\", header=TRUE)\nhh_reg$HH_ID_Y <- factor(paste(hh_reg$DB010,hh_reg$DB020,hh_reg$DB030, sep=\"_\"))\nhh_reg$HH_ID <- factor(paste(hh_reg$DB010,hh_reg$DB020,hh_reg$DB030, sep=\"_\"))\n# household data\nhh_data <- read.csv(\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\raw\\\\2010\\\\longi_rev1\\\\h_file.csv\", header=TRUE)\nhh_data$HH_ID_Y <- factor(paste(hh_data$HB010,hh_data$HB020,hh_data$HB030, sep=\"_\"))\nhh_data$HH_ID <- factor(paste(hh_data$HB010,hh_data$HB020,hh_data$HB030, sep=\"_\"))\n# personal register\nper_reg <- read.csv(\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\raw\\\\2010\\\\longi_rev1\\\\r_file.csv\", header=TRUE)\nper_reg$PER_ID_Y <- factor(paste(per_reg$RB010,per_reg$RB020,per_reg$RB030, sep=\"_\"))\nper_reg$PER_ID <- factor(paste(per_reg$RB010,per_reg$RB020,per_reg$RB030, sep=\"_\"))\n# personal data\nper_data <- read.csv(\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\raw\\\\2010\\\\longi_rev1\\\\p_file.csv\", header=TRUE)\nper_data$PER_ID_Y <- factor(paste(per_data$PB010,per_data$PB020,per_data$PB030, sep=\"_\"))\nper_data$PER_ID <- factor(paste(per_data$PB010,per_data$PB020,per_data$PB030, sep=\"_\"))\n#--------------------------------------------------------------------#\n# merge data\n# merge household datas\nlibrary(plyr)\nhh_merge <- join(hh_reg,hh_data,by=\"HH_ID_Y\", type=\"full\")\n# merge personal datas\nper_merge <- join(per_reg,per_data,by=\"PER_ID_Y\", type=\"full\")\nper_merge$HH_ID_Y <- factor(paste(per_merge$RB010,per_merge$RB020,per_merge$PX030, sep=\"_\"))\n# merge household and personal into single data\nrm(list=setdiff(ls(), c(\"hh_merge\",\"per_merge\",\"vars\",\"vars08\")))\nmerge <- join(hh_merge,per_merge,by=\"HH_ID_Y\", type=\"full\")\nboth_longi_2010 <- merge[,vars] \nrm(per_merge)\nrm(hh_merge)\nrm(merge)\n#--------------------------------------------------------------------#\n# Write merged file separate .RData files\nsave(both_longi_2010, file=\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\merged\\\\all\\\\both_longi_2010.RData\")\n\n\n\n# duplikaattien poistaminen\nboth_longi_2010$PB190.1 <- NULL\nboth_longi_2010$PB200.1 <- NULL\nboth_longi_2010$PE040.1 <- NULL\nboth_longi_2010$PL030.1 <- NULL\nboth_longi_2010$PL031.1 <- NULL\nboth_longi_2010$PL020.1 <- NULL\nboth_longi_2010$PL025.1 <- NULL\nboth_longi_2010$PL040.1 <- NULL\nboth_longi_2010$PL050.1 <- NULL\nboth_longi_2010$PL140.1 <- NULL\nboth_longi_2010$PL160.1 <- NULL\nboth_longi_2010$PL170.1 <- NULL\nboth_longi_2010$PL180.1 <- NULL\nboth_longi_2010$PL190.1 <- NULL\nboth_longi_2010$PL200.1 <- NULL\nboth_longi_2010$PY090N.1 <- NULL\nboth_longi_2010$PY140N.1 <- NULL\nboth_longi_2010$PY090G.1 <- NULL\nboth_longi_2010$PY140G.1 <- NULL\n\n\n\n\n\n## ------------------------------------------------ ##\n## ------------   POOLATAAN DATAT    -------------- ##\n## ------------------------------------------------ ##\n\n\n# Load the merged panel datasets\nload(\"..\\\\eusilc\\\\data\\\\merged\\\\all\\\\both_longi_2008.RData\")\nload(\"..\\\\eusilc\\\\data\\\\merged\\\\all\\\\both_longi_2009.RData\")\nload(\"..\\\\eusilc\\\\data\\\\merged\\\\all\\\\both_longi_2010.RData\")\n\n\n## ---------------------------------------------- ##\n## ------ Recoding PL030&PL031 ------------------ ##\n## ---------------------------------------------- ##\n\n# the information from PL030/PL031 is used. As those variables are \n# complementary (individuals have value in either of variable (missing data still \n# substantial problem!!) a synthetic variable `econStatus` is created so \n# **that value from PL031 is taken first, and if it is missing, the value from PL030 \n# is taken and simultaneuosly recoded to match PL031 coding**. \n# The results is a variable with values as in the table below.\n# \n# Table: values and labels in variable PL031\n# \n# | Value | Label |\n#   | ----- | ------ |\n#   | 1 | Employee working full-time |\n#   | 2 | Employee working part-time |\n#   | 3 | Self-employed working full-time (including family worker) |\n#   | 4 | Self-employed working part-time (including family worker) |\n#   | 5 | Unemployed |\n#   | 6 | Pupil, student, further training, unpaid work experience |\n#   | 7 | In retirement or in early retirement or has given up business |\n#   | 8 | Permanently disabled or/and unfit to work |\n#   | 9 | In compulsory military community or service |\n#   | 10 | Fulfilling domestic tasks and care responsibilities |\n#   | 11 | Other inactive person |\n#   \n#\n# let's code var econStatus by taking the PL031 as a bechmark\n#\n# Before making any corrections let's recode var PL030 using\n# PL031 classes into var PL030rec\n# 2008\nboth_longi_2008$PL030rec[both_longi_2008$PL030 == 1] <- 1\nboth_longi_2008$PL030rec[both_longi_2008$PL030 == 2] <- 2\nboth_longi_2008$PL030rec[both_longi_2008$PL030 == 3] <- 5\nboth_longi_2008$PL030rec[both_longi_2008$PL030 == 4] <- 6\nboth_longi_2008$PL030rec[both_longi_2008$PL030 == 5] <- 7\nboth_longi_2008$PL030rec[both_longi_2008$PL030 == 6] <- 8\nboth_longi_2008$PL030rec[both_longi_2008$PL030 == 7] <- 9\nboth_longi_2008$PL030rec[both_longi_2008$PL030 == 8] <- 10\nboth_longi_2008$PL030rec[both_longi_2008$PL030 == 9] <- 11\n# 2009\nboth_longi_2009$PL030rec[both_longi_2009$PL030 == 1] <- 1\nboth_longi_2009$PL030rec[both_longi_2009$PL030 == 2] <- 2\nboth_longi_2009$PL030rec[both_longi_2009$PL030 == 3] <- 5\nboth_longi_2009$PL030rec[both_longi_2009$PL030 == 4] <- 6\nboth_longi_2009$PL030rec[both_longi_2009$PL030 == 5] <- 7\nboth_longi_2009$PL030rec[both_longi_2009$PL030 == 6] <- 8\nboth_longi_2009$PL030rec[both_longi_2009$PL030 == 7] <- 9\nboth_longi_2009$PL030rec[both_longi_2009$PL030 == 8] <- 10\nboth_longi_2009$PL030rec[both_longi_2009$PL030 == 9] <- 11\n# 2010\nboth_longi_2010$PL030rec[both_longi_2010$PL030 == 1] <- 1\nboth_longi_2010$PL030rec[both_longi_2010$PL030 == 2] <- 2\nboth_longi_2010$PL030rec[both_longi_2010$PL030 == 3] <- 5\nboth_longi_2010$PL030rec[both_longi_2010$PL030 == 4] <- 6\nboth_longi_2010$PL030rec[both_longi_2010$PL030 == 5] <- 7\nboth_longi_2010$PL030rec[both_longi_2010$PL030 == 6] <- 8\nboth_longi_2010$PL030rec[both_longi_2010$PL030 == 7] <- 9\nboth_longi_2010$PL030rec[both_longi_2010$PL030 == 8] <- 10\nboth_longi_2010$PL030rec[both_longi_2010$PL030 == 9] <- 11\n\n# then we have to fill in missing values in PL031 with\n# values in PL030rec\n# let's create a PL031 with only NA values\nboth_longi_2008$PL031 <- NA\n\nboth_longi_2008$econStatus <- ifelse(is.na(both_longi_2008$PL031), \n                                     both_longi_2008$PL030rec, \n                                     both_longi_2008$PL031)\nboth_longi_2009$econStatus <- ifelse(is.na(both_longi_2009$PL031), \n                                     both_longi_2009$PL030rec, \n                                     both_longi_2009$PL031)\nboth_longi_2010$econStatus <- ifelse(is.na(both_longi_2010$PL031), \n                                     both_longi_2010$PL030rec, \n                                     both_longi_2010$PL031)\n\n# Poistetaan PL030/PL031 muuttujat\n\nboth_longi_2008$PL030 <- NULL\nboth_longi_2008$PL030rec <- NULL\nboth_longi_2008$PL031 <- NULL\n\nboth_longi_2009$PL030 <- NULL\nboth_longi_2009$PL030rec <- NULL\nboth_longi_2009$PL031 <- NULL\n\nboth_longi_2010$PL030 <- NULL\nboth_longi_2010$PL030rec <- NULL\nboth_longi_2010$PL031 <- NULL\n\ndat <- rbind(both_longi_2008,\n             both_longi_2009,\n             both_longi_2010)\n\n\nsave(dat, file=\"C:\\\\Vanha D\\\\R\\\\eusilc\\\\data\\\\merged\\\\all\\\\dat.RData\")\n\n\n# merge the panels datas\ndat$dup <- duplicated(dat$PER_ID_Y)\ndat.uniq <- dat[dat$dup == FALSE,]\ndat.uniq$dup <- NULL\ndat.per <- dat.uniq\n\ndat$dup <- duplicated(dat$HH_ID)\ndat.uniq <- dat[dat$dup == FALSE,]\ndat.uniq$dup <- NULL\ndat.hh <- dat.uniq\ndat.hh <- dat.hh[!is.na(dat.hh$HX050), ]\n## Merge some files from household data\ndat.per <- merge(dat.per,dat.hh,\n                 by.x=c(\"RB010\",\"RB020\",\"RB040\"),\n                 by.y=c(\"DB010\",\"DB020\",\"DB030\"),\n                 all.x=TRUE)\nsave(dat.per, file=\"data/dat.per.RData\")\n\n\n\n\n\nlibrary(r.eusilc)\nboth_longi_202008 <- merge_eusilc(origin.path=path.raw,\n                                output.path=path.merged,\n                                level=\"both\",\n                                type=\"longitudinal\",\n                                year=\"2008\",\n                                format=\"Stata\",\n                                subset.vars=\"all\",\n                                subset.countries=\"all\") \n\nlibrary(r.eusilc)\nboth_longi_202009 <- merge_eusilc(origin.path=\"..\\\\eusilc\\\\data\\\\raw\\\\2009\\\\longi_rev3\",\n                                output.path=\"..\\\\eusilc\\\\data\\\\merged\\\\2009\",\n                                level=\"both\",\n                                type=\"longitudinal\",\n                                year=\"2009\",\n                                format=\"Stata\",\n                                subset.vars=\"all\",\n                                subset.countries=\"all\") \n\nlibrary(r.eusilc)\nboth_longi_202010 <- merge_eusilc(origin.path=\"..\\\\eusilc\\\\data\\\\raw\\\\2010\\\\longi_rev1\",\n                                output.path=\"..\\\\eusilc\\\\data\\\\merged\\\\2010\",\n                                level=\"both\",\n                                type=\"longitudinal\",\n                                year=\"2010\",\n                                format=\"Stata\",\n                                subset.vars=\"all\",\n                                subset.countries=\"all\") \n\n\n\n\n\nmerge_eusilc()\n\n\n\n\n\n\n\nlibrary(r.eusilc)\nhh_longi_2008 <- merge_eusilc(origin.path=\"..\\\\eusilc\\\\data\\\\raw\\\\2008\\\\longi_rev4\",\n                                output.path=\"..\\\\eusilc\\\\data\\\\merged\\\\2008\",\n                                level=\"household\",\n                                type=\"longitudinal\",\n                                year=\"2008\",\n                                format=\"csv\",\n                                subset.vars=\"all\",\n                                subset.countries=c(\"FI\",\"SE\")) ",
    "created" : 1395751048413.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4275483863",
    "id" : "5F8B7168",
    "lastKnownWriteTime" : 1395751045,
    "path" : "/tmp/datojen_luominen.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}